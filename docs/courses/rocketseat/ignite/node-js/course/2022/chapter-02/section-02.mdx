---
id: section-02
title: Ignite Node.js · 2022 · Chapter 02 · Section 02
sidebar_label: Section 02
description: Ignite Node.js by RocketSeat.
keywords:
  - Alex Bleggi
image: /static/other/img/profile.png
slug: /ignite/node-js-2022/course/2022/chapter-02/section-02
toc_max_heading_level: 4
hide_title: true
---

import useBaseUrl from '@docusaurus/useBaseUrl';

# Criando a API com NodeJS

## [Configurando ts-node-dev](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/configurando-ts-node-dev)

```bash
# npm
npm i express

# yarn
yarn add express
```

```bash
# npm
npm i @types/express typescript ts-node-dev -D

# yarn
yarn add @types/express typescript ts-node-dev -D
```

```bash
# npm
npx tsc --init

# yarn
yarn tsc --init
```

```json {2} title="package.json"
"scripts": {
  "dev": "ts-node-dev --transpile-only --ignore-watch node_modules --respawn src/server.ts"
}
```

```typescript {1,3,5-7,9} title="src/server.ts"
import express from 'express';

const app = express();

app.get('/', (request, response) => {
  return response.json({ message: 'Hello world' });
});

app.listen(3333, () => console.log('Server is running'));
```

## [Debugando a aplicação](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/debugando-a-aplicacao)

```json {2} title="package.json"
"scripts": {
  "dev": "ts-node-dev --inspect --transpile-only --ignore-watch node_modules --respawn src/server.ts"
}
```

```json {1-12} title=".vscode/launch.json"
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "node",
      "request": "attach",
      "name": "Launch Program",
      "skipFiles": ["<node_internals>/**"],
      "outFiles": ["${workspaceFolder}/**/*.js"]
    }
  ]
}
```

## [Criando categoria](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/criando-categoria)

```typescript {1,3,4,6-15,17} title="src/routes/categories.routes.ts"
import { Router } from 'express';

const categoriesRoutes = Router();
const categories = [];

categoriesRoutes.post('/categories', (request, response) => {
  const { name, description } = request.body;

  categories.push({
    name,
    description,
  });

  return response.status(201).send();
});

export { categoriesRoutes };
```

```typescript {2,6,8} title="src/server.ts"
import express from 'express';
import { categoriesRoutes } from './routes/categories.routes';

const app = express();

app.use(express.json());

app.use(categoriesRoutes);

app.listen(3333, () => console.log('Server is running'));
```

## [Inserindo ID com uuid](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/inserindo-id-com-uuid)

```bash
# npm
npm i uuid

# yarn
yarn add uuid
```

```bash
# npm
npm i @types/uuid -D

# yarn
yarn add @types/uuid -D
```

```typescript {2,7,10-14,16} title="src/routes/categories.routes.ts"
import { Router } from 'express';
import { v4 as uuidV4 } from 'uuid';

const categoriesRoutes = Router();
const categories = [];

categoriesRoutes.post('/', (request, response) => {
  const { name, description } = request.body;

  const category = {
    id: uuidV4(),
    name,
    description,
  };

  categories.push(category);

  return response.status(201).send();
});

export { categoriesRoutes };
```

```typescript {8} title="src/server.ts"
import express from 'express';
import { categoriesRoutes } from './routes/categories.routes';

const app = express();

app.use(express.json());

app.use('/categories', categoriesRoutes);

app.listen(3333, () => console.log('Server is running'));
```

## [Inserindo tipagem para categoria](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/inserindo-tipagem-para-categoria)

```typescript {1,3-14,16} title="src/modeel/category.ts"
import { v4 as uuidV4 } from 'uuid';

class Category {
  id?: string;
  name: string;
  description: string;
  create_at: Date;

  constructor() {
    if (!this.id) {
      this.id = uuidV4();
    }
  }
}

export { Category };
```

```typescript {2,5,10,11,15} title="src/routes/categories.routes.ts"
import { Router } from 'express';
import { Category } from '../model/category';

const categoriesRoutes = Router();
const categories: Category[] = [];

categoriesRoutes.post('/', (request, response) => {
  const { name, description } = request.body;

  const category = new Category();
  Object.assign(category, { name, description, create_at: new Date() });

  categories.push(category);

  return response.status(201).json({ category });
});

export { categoriesRoutes };
```

## [Criando repositório de categoria](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/criando-repositorio-de-categoria)

```typescript title="src/repositories/CategoriesRepository.ts"
import { Category } from '../model/category';

// DTO: Data Transfer Object
interface ICreateCategoryDTO {
  name: string;
  description: string;
}

class CateoriesRepository {
  private categories: Category[];

  constructor() {
    this.categories = [];
  }

  create({ name, description }: ICreateCategoryDTO) {
    const category = new Category();

    Object.assign(category, { name, description, create_at: new Date() });

    this.categories.push(category);
  }
}

export { CateoriesRepository };
```

```typescript {2,5,10,12} title="src/routes/categories.routes.ts"
import { Router } from 'express';
import { CateoriesRepository } from '../repositories/CategoriesRepository';

const categoriesRoutes = Router();
const categoriesRepository = new CateoriesRepository();

categoriesRoutes.post('/', (request, response) => {
  const { name, description } = request.body;

  categoriesRepository.create({ name, description });

  return response.status(201).send();
});

export { categoriesRoutes };
```

## [Listando as categorias](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/listando-as-categorias)

```typescript {24-26} title="src/repositories/CategoriesRepository.ts"
import { Category } from '../model/category';

// DTO: Data Transfer Object
interface ICreateCategoryDTO {
  name: string;
  description: string;
}

class CateoriesRepository {
  private categories: Category[];

  constructor() {
    this.categories = [];
  }

  create({ name, description }: ICreateCategoryDTO) {
    const category = new Category();

    Object.assign(category, { name, description, create_at: new Date() });

    this.categories.push(category);
  }

  list(): Category[] {
    return this.categories;
  }
}

export { CateoriesRepository };
```

```typescript {15-19} title="src/routes/categories.routes.ts"
import { Router } from 'express';
import { CateoriesRepository } from '../repositories/CategoriesRepository';

const categoriesRoutes = Router();
const categoriesRepository = new CateoriesRepository();

categoriesRoutes.post('/', (request, response) => {
  const { name, description } = request.body;

  categoriesRepository.create({ name, description });

  return response.status(201).send();
});

categoriesRoutes.get('/', (request, response) => {
  const all = categoriesRepository.list();

  return response.json(all);
});

export { categoriesRoutes };
```

## [Validando o cadastro de categoria](https://app.rocketseat.com.br/node/chapter-ii-2/group/criando-a-api-com-node-js/lesson/validando-o-cadastro-de-categoria)

```typescript {28-31} title="src/repositories/CategoriesRepository.ts"
import { Category } from '../model/category';

// DTO: Data Transfer Object
interface ICreateCategoryDTO {
  name: string;
  description: string;
}

class CateoriesRepository {
  private categories: Category[];

  constructor() {
    this.categories = [];
  }

  create({ name, description }: ICreateCategoryDTO) {
    const category = new Category();

    Object.assign(category, { name, description, create_at: new Date() });

    this.categories.push(category);
  }

  list(): Category[] {
    return this.categories;
  }

  findByName(name: string): Category {
    const category = this.categories.find((category) => category.name === name);
    return category;
  }
}

export { CateoriesRepository };
```

```typescript {10,11-13} title="src/routes/categories.routes.ts"
import { Router } from 'express';
import { CateoriesRepository } from '../repositories/CategoriesRepository';

const categoriesRoutes = Router();
const categoriesRepository = new CateoriesRepository();

categoriesRoutes.post('/', (request, response) => {
  const { name, description } = request.body;

  const categoryAlreadyExists = categoriesRepository.findByName(name);
  if (categoryAlreadyExists) {
    return response.status(400).send({ error: 'Category already exists!' });
  }

  categoriesRepository.create({ name, description });

  return response.status(201).send();
});

categoriesRoutes.get('/', (request, response) => {
  const all = categoriesRepository.list();

  return response.json(all);
});

export { categoriesRoutes };
```
